<!--
  This page calls a single bidder for a single ad slot. It can be considered a "hello world" example for using
  Prebid with the Google Publisher Tag.
  It also makes a good test page for new adapter PR submissions. Simply set your server's Bid Params object in the
  bids array inside the adUnits, and it will use your adapter to load an ad.
  NOTE that many ad servers won't send back an ad if the URL is localhost... so you might need to
  set an alias in your /etc/hosts file so that you can load this page from a different domain.
-->

<html>
<head>
  <script async src="../../build/dev/prebid.js"></script>
  <script async src="https://www.googletagservices.com/tag/js/gpt.js"></script>
  <script>
    var FAILSAFE_TIMEOUT = 3300;
    var PREBID_TIMEOUT = 1000;

    var adUnits = [{
      code: 'div-gpt-ad-1460505748561-0',
      mediaTypes: {
        banner: {
          sizes: [[300, 250], [300, 600]],
        }
      },
      // Replace this object to test a new Adapter!
      bids: [{
        bidder: 'appnexus',
        params: {
          placementId: 13144370
        }
      },{
                       bidder: "rubicon",
                       params: {
                           accountId: 14062,
                           siteId: 70608,
                           zoneId: 498816
                       }
                   }]

    }];

    var pbjs = pbjs || {};
    pbjs.que = pbjs.que || [];

  </script>

  <script>
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
    googletag.cmd.push(function () {
      googletag.pubads().disableInitialLoad();
    });

    pbjs.que.push(function () {
      pbjs.addAdUnits(adUnits);
      pbjs.setConfig({
        userSync: {	
          userIds: [{	
            name: "id5Id",	
            params: {	
              partner: 173             // change to the Partner Number you received from ID5	
            },	
            storage: {	
              type: "cookie",	
              name: "pbjs-id5id",      // create a cookie with this name	
              expires: 90,             // cookie lasts for 90 days	
              refreshInSeconds: 8*3600 // refresh ID every 8 hours to ensure it's fresh	
						}
          }, {
						name: "criteo"
					}],	
          syncDelay: 1000              // 1 second after the first bidRequest()	
        },
        debug: true,
        consentManagement: {
          gdpr: {
						cmpApi: 'static',
						rules: [{
							purpose: 'measurement',
							enforcePurpose: true,
							enforceVendor: true,
							vendorExceptions: []
						}],
            // allowAuctionWithoutConsent: true,
            timeout: 5000,
            consentData: {
              getTCData: {
                "tcString": "COuqj-POu90rDBcBkBENAZCgAPzAAAPAACiQFwwBAABAA1ADEAbQC4YAYAAgAxAG0A",
                "cmpId": 92,
                "cmpVersion": 100,
                "tcfPolicyVersion": 2,
                "gdprApplies": true,
                "isServiceSpecific": true,
                "useNonStandardStacks": false,
                "purposeOneTreatment": false,
                "publisherCC": "US",
                "cmpStatus": "loaded",
                "eventStatus": "tcloaded",
                "outOfBand": {
                  "allowedVendors": {},
                  "discloseVendors": {}
                },
                "purpose": {
                  "consents": {
                    "1": true,
                    "2": true,
                    "3": true,
                    "4": true,
                    "5": true,
                    "6": true,
                    "7": true,
                    "8": false,
                    "9": true,
                    "10": true
                  },
                  "legitimateInterests": {
                    "1": false,
                    "2": false,
                    "3": false,
                    "4": false,
                    "5": false,
                    "6": false,
                    "7": true,
                    "8": true,
                    "9": true,
                    "10": true
                  }
                },
                "vendor": {
                  "consents": {
                    "131": true,
										"32": true,
                    "52": true,
                    "1": false,
                    "2": true,
                    "3": false,
                    "4": false,
                    "5": false,
                    "6": false,
                    "7": false,
                    "8": false,
                    "9": false,
                    "10": false,
                    "11": false,
                    "12": false,
                    "13": false,
                    "14": false,
                    "15": false,
                    "16": false,
                    "17": false,
                    "18": false,
                    "19": false,
                    "20": false,
                    "21": false,
                    "22": false,
                    "23": false,
                    "24": false,
                    "25": false,
                    "26": false,
                    "27": false,
                    "28": false,
                    "29": false,
                    "30": false,
                    "31": false,
                    "33": false,
                    "34": false,
                    "35": false,
                    "36": false,
                    "37": false,
                    "38": false,
                    "39": false,
                    "40": false,
                    "41": false,
                    "42": false,
                    "43": false,
                    "44": false,
                    "45": false,
                    "46": false,
                    "47": false,
                    "48": false,
                    "49": false,
                    "50": false,
                    "51": false,
                    "53": true,
                    "54": false,
                    "55": false,
                    "56": false,
                    "57": false,
                    "58": false,
                    "59": false,
                    "60": false,
                    "61": false,
                    "62": false,
                    "63": false,
                    "64": false,
                    "65": false,
                    "66": false,
                    "67": false,
                    "68": false,
                    "69": false,
                    "70": false,
                    "71": false,
                    "72": false,
                    "73": false,
                    "74": false,
                    "75": false,
                    "76": false,
                    "77": false,
                    "78": false,
                    "79": false,
                    "80": false,
                    "81": false,
                    "82": false,
                    "83": false,
                    "84": false,
                    "85": false,
                    "86": false,
                    "87": false,
                    "88": false,
                    "89": false,
                    "90": false,
                    "91": false,
                    "92": false,
                    "93": false,
                    "94": false,
                    "95": false,
                    "96": false,
                    "97": false,
                    "98": true,
                    "99": false,
                    "100": false,
                    "101": false,
                    "102": false,
                    "103": false,
                    "104": false,
                    "105": false,
                    "106": false,
                    "107": false,
                    "108": false,
                    "109": false,
                    "110": false,
                    "111": true,
                    "112": true,
                    "113": false,
                    "114": false,
                    "115": false,
                    "116": false,
                    "117": false,
                    "118": false,
                    "119": false,
                    "120": false,
                    "121": false,
                    "122": false,
                    "123": false,
                    "124": false,
                    "125": false,
                    "126": false,
                    "127": false,
                    "128": false,
                    "129": false,
                    "130": false,
                    "132": false,
                  },
                  "legitimateInterests": {
                    "1": false,
                    "2": true,
                    "3": false,
                    "4": false,
                    "5": false,
                    "6": false,
                    "7": false,
                    "8": false,
                    "9": false,
                    "10": false,
                    "11": false,
                    "12": false,
                    "13": false,
                    "14": false,
                    "15": false,
                    "16": false,
                    "17": false,
                    "18": false,
                    "19": false,
                    "20": false,
                    "21": false,
                    "22": false,
                    "23": false,
                    "24": false,
                    "25": false,
                    "26": false,
                    "27": false,
                    "28": false,
                    "29": false,
                    "30": false,
                    "31": false,
                    "32": false,
                    "33": false,
                    "34": false,
                    "35": false,
                    "36": false,
                    "37": false,
                    "38": false,
                    "39": false,
                    "40": false,
                    "41": false,
                    "42": false,
                    "43": false,
                    "44": false,
                    "45": false,
                    "46": false,
                    "47": false,
                    "48": false,
                    "49": false,
                    "50": false,
                    "51": false,
                    "52": false,
                    "53": false,
                    "54": false,
                    "55": false,
                    "56": false,
                    "57": false,
                    "58": false,
                    "59": false,
                    "60": false,
                    "61": false,
                    "62": false,
                    "63": false,
                    "64": false,
                    "65": false,
                    "66": false,
                    "67": false,
                    "68": false,
                    "69": false,
                    "70": false,
                    "71": false,
                    "72": false,
                    "73": false,
                    "74": false,
                    "75": false,
                    "76": false,
                    "77": false,
                    "78": false,
                    "79": false,
                    "80": false,
                    "81": false,
                    "82": false,
                    "83": false,
                    "84": false,
                    "85": false,
                    "86": false,
                    "87": false,
                    "88": false,
                    "89": false,
                    "90": false,
                    "91": false,
                    "92": false,
                    "93": false,
                    "94": false,
                    "95": false,
                    "96": false,
                    "97": false,
                    "98": true,
                    "99": false,
                    "100": false,
                    "101": false,
                    "102": false,
                    "103": false,
                    "104": false,
                    "105": false,
                    "106": false,
                    "107": false,
                    "108": false,
                    "109": false,
                    "110": false,
                    "111": false,
                    "112": false,
                    "113": false,
                    "114": false,
                    "115": false,
                    "116": false,
                    "117": false,
                    "118": false,
                    "119": false,
                    "120": false,
                    "121": false,
                    "122": false,
                    "123": false,
                    "124": false,
                    "125": false,
                    "126": false,
                    "127": false,
                    "128": false,
                    "129": false,
                    "130": false,
                    "131": false,
                  }
                },
                "specialFeatureOptins": {
                  "1": false,
                  "2": false
                },
                "restrictions": {},
                "publisher": {
                  "consents": {
                    "1": false,
                    "2": false,
                    "3": false,
                    "4": false,
                    "5": false,
                    "6": false,
                    "7": false,
                    "8": false,
                    "9": false,
                    "10": false
                  },
                  "legitimateInterests": {
                    "1": false,
                    "2": false,
                    "3": false,
                    "4": false,
                    "5": false,
                    "6": false,
                    "7": false,
                    "8": false,
                    "9": false,
                    "10": false
                  },
                  "customPurpose": {
                    "consents": {},
                    "legitimateInterests": {}
                  }
                }
              }
            }
          }
        }
			});
			pbjs.enableAnalytics({
				provider: 'yuktamedia',
				options: {
					pubId: 50357,
					enableUTMCollection: true,
					enableSession: true,
					enableUserIdCollection: true
				}
			});
      pbjs.requestBids({
        bidsBackHandler: sendAdserverRequest,
        timeout: PREBID_TIMEOUT
      });
    });

    function sendAdserverRequest() {
      if (pbjs.adserverRequestSent) return;
      pbjs.adserverRequestSent = true;
      googletag.cmd.push(function () {
        pbjs.que.push(function () {
          pbjs.setTargetingForGPTAsync();
          googletag.pubads().refresh();
        });
      });
    }

    setTimeout(function () {
      sendAdserverRequest();
    }, FAILSAFE_TIMEOUT);

  </script>

  <script>
    googletag.cmd.push(function () {
      googletag.defineSlot('/19968336/header-bid-tag-0', [[300, 250], [300, 600]], 'div-gpt-ad-1460505748561-0').addService(googletag.pubads());

      googletag.pubads().enableSingleRequest();
      googletag.enableServices();
    });
  </script>
</head>

<body>
  <h2>Prebid.js Test</h2>
  <h5>Div-1</h5>
  <div id='div-gpt-ad-1460505748561-0'>
    <script type='text/javascript'>
      googletag.cmd.push(function () { googletag.display('div-gpt-ad-1460505748561-0'); });
    </script>
  </div>
</body>

</html>
